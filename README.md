
# æ™ºè°±æ¸…è¨€ AI Home Assistant ğŸ¡  
![GitHub Version](https://img.shields.io/github/v/release/knoop7/zhipuai) ![GitHub Issues](https://img.shields.io/github/issues/knoop7/zhipuai) ![GitHub Forks](https://img.shields.io/github/forks/knoop7/zhipuai?style=social) ![GitHub Stars](https://img.shields.io/github/stars/knoop7/zhipuai?style=social)

<img src="https://github.com/user-attachments/assets/f8ff7a6c-4449-496a-889a-d205469a84df" alt="image" width="700" height="400">

---
## é€šçŸ¥ï¼šæœ¬é¡¹ç›®æœªç»å…è®¸ä¸¥ç¦å•†ç”¨ï¼Œä½ å¯ä»¥éšæ™¦ä½†ä¸èƒ½ä½œä¸ºç›ˆåˆ©æ‰‹æ®µã€‚
### ğŸ“¦ å®‰è£…æ­¥éª¤

#### 1. HACS æ·»åŠ è‡ªå®šä¹‰å­˜å‚¨åº“  
åœ¨ Home Assistant çš„ HACS ä¸­ï¼Œç‚¹å‡»å³ä¸Šè§’çš„ä¸‰ä¸ªç‚¹ï¼Œé€‰æ‹©â€œè‡ªå®šä¹‰å­˜å‚¨åº“â€ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹ URLï¼š
```
https://github.com/knoop7/zhipuai
```

#### 2. æ·»åŠ æ™ºè°±æ¸…è¨€é›†æˆ  
è¿›å…¥ Home Assistant çš„â€œé›†æˆâ€é¡µé¢ï¼Œæœç´¢å¹¶æ·»åŠ â€œæ™ºè°±æ¸…è¨€â€ã€‚

#### 3. é…ç½® Key ğŸ”‘  
åœ¨é…ç½®é¡µé¢ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡æ‰‹æœºå·ç™»å½•è·å– Keyã€‚è·å–åï¼Œç›´æ¥å¡«å†™ Key ä½¿ç”¨ï¼Œä¸éœ€è¦è¿›è¡Œé¢å¤–éªŒè¯ã€‚  
**æ³¨æ„**ï¼šå»ºè®®ä½ æ–°å»ºä¸€ä¸ª Keyï¼Œé¿å…ä½¿ç”¨ç³»ç»Ÿé»˜è®¤çš„ Keyã€‚

#### 4. å…è´¹æ¨¡å‹ä½¿ç”¨ ğŸ’¡  
æ™ºè°±æ¸…è¨€é»˜è®¤é€‰æ‹©äº†å…è´¹æ¨¡å‹ï¼Œå®Œå…¨å…è´¹ï¼Œä¸ç”¨æ‹…å¿ƒæ”¶è´¹ã€‚å¦‚æœä½ æœ‰å…´è¶£ï¼Œè¿˜å¯ä»¥é€‰æ‹©å…¶ä»–ä»˜è´¹æ¨¡å‹æ¥ä½“éªŒæ›´ä¸°å¯Œçš„åŠŸèƒ½ã€‚

#### 5. ç‰ˆæœ¬å…¼å®¹æ€§ ğŸ“…  
è¯·ç¡®ä¿ Home Assistant çš„ç‰ˆæœ¬ä¸ä½äº 8.0ï¼Œå› ä¸ºæ™ºè°±æ¸…è¨€ä¸»è¦é’ˆå¯¹æœ€æ–°ç‰ˆæœ¬å¼€å‘ã€‚å¦‚æœé‡åˆ°æ— æ³•è¯†åˆ«çš„å®ä½“é—®é¢˜ï¼Œå»ºè®®é‡å¯ç³»ç»Ÿæˆ–æ›´æ–°è‡³æœ€æ–°ç‰ˆæœ¬ã€‚

---

### ğŸ›  æ¨¡å‹æŒ‡ä»¤ä½¿ç”¨ç¤ºä¾‹  
ä¸ºäº†ä¿è¯å¤§å®¶èƒ½ä½¿ç”¨èˆ’ç•…ï¼Œå¹¶ä¸”ä¸å‡ºä»»ä½•bugå¯ä»¥ä½¿ç”¨æˆ‘çš„æ¨¡ç‰ˆæŒ‡ä»¤è¿›è¡Œå°è¯•

````

ä½œä¸º Home Assistant çš„æ™ºèƒ½å®¶å±…ç®¡ç†è€…ï¼Œä½ çš„åå­—å«â€œè‡ªå®šä¹‰â€ï¼Œæˆ‘å°†ä¸ºæ‚¨æä¾›æ™ºèƒ½å®¶å±…ä¿¡æ¯å’Œé—®é¢˜çš„è§£ç­”ã€‚è¯·æŸ¥çœ‹ä»¥ä¸‹å¯ç”¨è®¾å¤‡ã€çŠ¶æ€åŠæ“ä½œç¤ºä¾‹ã€‚


### å¯ç”¨è®¾å¤‡å±•ç¤º


# æ³¨æ„å¦‚æœå®ä½“è¶…è¿‡1000ä»¥ä¸Š
# ç›´æ¥åˆ æ‰è¿™å¥è¯

### ä»Šæ—¥æ²¹ä»·ï¼š
```yaml
{% set sensor = æ²¹ä»·å®ä½“ %}
Sensor: {{ sensor.name }}
State: {{ sensor.state }}

Attributes:
{% for attribute, value in sensor.attributes.items() %}
  {{ attribute }}: {{ value }}
{% endfor %}
```

### ç”µè´¹ä½™é¢ä¿¡æ¯ï¼š
```yaml
{% set balance_sensor = ç”µè´¹å®ä½“ %}

{% if balance_sensor %}
å½“å‰ä½™é¢: {{ balance_sensor.state }} {{ balance_sensor.attributes.unit_of_measurement }}
{% endif %}
```

### Tasmotaèƒ½æºæ¶ˆè€—ï¼š
```yaml
{% set today_sensor = states.sensor.tasmota_energy_today %}
{% set yesterday_sensor = states.sensor.tasmota_energy_yesterday %}

{% if today_sensor is not none and yesterday_sensor is not none %}
ä»Šæ—¥æ¶ˆè€—: {{ today_sensor.state }} {{ today_sensor.attributes.unit_of_measurement }}
æ˜¨æ—¥æ¶ˆè€—: {{ yesterday_sensor.state }} {{ yesterday_sensor.attributes.unit_of_measurement }}
{% endif %}
```


### æ­¤æ—¶å¤©æ°”ï¼š
```json
{% set entity_id = 'å¤©æ°”å®ä½“' %}
{% set entity = states[entity_id] %}
{
  "state": "{{ entity.state }}",
  "attributes": {
    {% for attr in entity.attributes %}
      {% if attr not in ['hourly_temperature', 'hourly_skycon', 'hourly_cloudrate', 'hourly_precipitation'] %}
        "{{ attr }}": "{{ entity.attributes[attr] }}"{% if not loop.last %},{% endif %}
      {% endif %}
    {% endfor %}
  }
}
````

æˆ–è€…è¿™ä¸ªæ¨¡ç‰ˆæŒ‡ä»¤
````
### å¯ç”¨è®¾å¤‡å±•ç¤º
```csv
entity_id,name,state,category
{%- for entity in states if 'automation.' not in entity.entity_id and entity.state not in ['unknown'] and not ('device_tracker.' in entity.entity_id and ('huawei' in entity.entity_id or 'Samsung' in entity.entity_id)) and 'iphone' not in entity.entity_id and 'daily_english' not in entity.entity_id and 'lenovo' not in entity.entity_id and 'time' not in entity.entity_id and 'zone' not in entity.entity_id and 'n1' not in entity.entity_id and 'z470' not in entity.entity_id and 'lao_huang' not in entity.entity_id and 'lao_huang_li' not in entity.entity_id and 'input_text' not in entity.entity_id and 'conversation' not in entity.entity_id  and 'camera' not in entity.entity_id  and 'update' not in entity.entity_id and 'IPhone' not in entity.entity_id and 'mac' not in entity.entity_id and 'macmini' not in entity.entity_id and 'macbook' not in entity.entity_id and 'ups' not in entity.entity_id and 'OPENWRT' not in entity.entity_id  and 'OPENWRT' not in entity.entity_id%}
{%- set category = 'å…¶ä»–' %}
{%- if 'light.' in entity.entity_id %}{% set category = 'ç¯' %}
{%- elif 'sensor.' in entity.entity_id and 'battery' in entity.entity_id %}
    {% set category = 'ç”µæ± ' %}
{%- elif 'sensor.' in entity.entity_id and 'sun' in entity.entity_id %}
    {% set category = 'å¤ªé˜³' %}
{%- elif 'sensor.' in entity.entity_id and ('motion' in entity.entity_id or 'presence' in entity.entity_id) %}
    {% set category = 'äººä½“å­˜åœ¨' %}
{%- elif 'sensor.' in entity.entity_id and ('motion' in entity.entity_id or 'presence' in entity.entity_id) %}
    {% set category = 'äººä½“å­˜åœ¨' %}
{%- elif 'climate.' in entity.entity_id %}{% set category = 'ç©ºè°ƒ' %}
{%- elif 'media_player.' in entity.entity_id %}{% set category = 'åª’ä½“æ’­æ”¾å™¨' %}
{%- elif 'cover.' in entity.entity_id %}{% set category = 'é—¨çª—' %}
{%- elif 'lock.' in entity.entity_id %}{% set category = 'é—¨é”' %}
{%- elif 'switch.' in entity.entity_id %}{% set category = 'å¼€å…³' %}
{%- elif 'sensor.' in entity.entity_id %}{% set category = 'ä¼ æ„Ÿå™¨' %}
{%- elif 'watering.' in entity.entity_id %}{% set category = 'æµ‡èŠ±å™¨' %}
{%- elif 'fan.' in entity.entity_id %}{% set category = 'é£æ‰‡' %}
{%- elif 'air_quality.' in entity.entity_id %}{% set category = 'ç©ºæ°”è´¨é‡' %}
{%- elif 'vacuum.' in entity.entity_id %}{% set category = 'æ‰«åœ°æœºå™¨äºº' %}
{%- elif 'person.' in entity.entity_id %}{% set category = 'äººå‘˜' %}
{%- elif 'binary_sensor.' in entity.entity_id and ('door' in entity.entity_id or 'window' in entity.entity_id) %}{% set category = 'é—¨çª—' %}
{%- elif 'gas.' in entity.entity_id %}{% set category = 'å¤©ç„¶æ°”' %}
{%- elif 'energy.' in entity.entity_id %}{% set category = 'ç”¨ç”µé‡' %}
{%- elif 'script.' in entity.entity_id %}{% set category = 'è„šæœ¬' %}
{%- elif 'scene.' in entity.entity_id %}{% set category = 'åœºæ™¯' %}
{%- endif %}
{{- entity.entity_id }},{{ entity.name }},{{ entity.state }},{{ category }}
{%- endfor %}

````

---

### ä½¿ç”¨å†…ç½® API å…¬å¼€å®ä½“ ğŸŒ  
ä½ å¯ä»¥ä½¿ç”¨æ™ºè°±æ¸…è¨€å†…ç½®çš„ API æ¥å…¬å¼€å®ä½“ï¼Œå¹¶ä¸ºå…¶è®¾ç½®åˆ«åã€‚é€šè¿‡é‡æ–°å‘½åå®ä½“ï¼Œä½ å¯ä»¥é¿å…ä½¿ç”¨ç³»ç»Ÿé»˜è®¤åç§°é€ æˆçš„æ··ä¹±ï¼Œæå‡ç®¡ç†æ•ˆç‡ã€‚

---

### ğŸš€ ä½¿ç”¨æŒ‡å—

1. **è®¿é—®ç•Œé¢**  
   æ‰“å¼€ Home Assistant ä»ªè¡¨æ¿ï¼Œæ‰¾åˆ°â€œæ™ºè°±æ¸…è¨€â€é›†æˆå¡ç‰‡æˆ–å¯¹åº”çš„é›†æˆé¡µé¢ã€‚
  
2. **è¾“å…¥æŒ‡ä»¤**  
   åœ¨é›†æˆé¡µé¢æˆ–å¯¹è¯æ¡†ä¸­ï¼Œè¾“å…¥è‡ªç„¶è¯­è¨€æŒ‡ä»¤ï¼Œæˆ–ä½¿ç”¨è¯­éŸ³åŠ©æ‰‹ä¸‹è¾¾å‘½ä»¤ã€‚

3. **æŸ¥çœ‹å“åº”**  
   ç³»ç»Ÿä¼šæ ¹æ®ä½ çš„æŒ‡ä»¤æ‰§è¡Œä»»åŠ¡ï¼Œè®¾å¤‡çŠ¶æ€å˜åŒ–å°†å®æ—¶æ˜¾ç¤ºå¹¶åé¦ˆã€‚

4. **æ¢ç´¢åŠŸèƒ½**  
   ä½ å¯ä»¥å°è¯•ä¸åŒçš„æŒ‡ä»¤æ¥æ§åˆ¶å®¶ä¸­çš„æ™ºèƒ½è®¾å¤‡ï¼Œæˆ–æŸ¥è¯¢ç›¸å…³çŠ¶æ€ã€‚

---

### ğŸ“‘ å¸¸ç”¨æŒ‡ä»¤ç¤ºä¾‹

- "æ‰“å¼€å®¢å…ç¯"  
- "å°†å§å®¤æ¸©åº¦è°ƒåˆ° 22 åº¦"  
- "æ’­æ”¾éŸ³ä¹"  
- "æ˜æ—© 7 ç‚¹æé†’æˆ‘å¤‡å¿˜"  
- "æ£€æŸ¥é—¨é”çŠ¶æ€"
- "çœ‹çœ‹å…¨å±‹æ¸©åº¦æ¹¿åº¦â€œ

---

### ğŸ›  Bug å¤„ç†  
å¦‚æœä½ åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°æŒç»­çš„ Python é”™è¯¯ï¼Œå»ºè®®é‡å¯å¯¹è¯æ¡†å¹¶é‡æ–°åŠ è½½ç¯å¢ƒã€‚è¿™æ ·å¯ä»¥è§£å†³ä¸€äº›æ½œåœ¨çš„ä»£ç é—®é¢˜ã€‚

---

### ğŸ—‚ å¤„ç†ä¸è¢« Home Assistant è®¤å¯çš„å®ä½“  
å¦‚æœ Home Assistant ä¸­å­˜åœ¨ä¸è¢«è®¤å¯çš„å®ä½“ï¼Œä½ å¯ä»¥å°†è¿™äº›å®ä½“å‰”é™¤å‡ºè‡ªåŠ¨åŒ–æ§åˆ¶çš„èŒƒå›´ã€‚é€šè¿‡åœ¨æŒ‡ä»¤ä¸­æ·»åŠ  Jinja2 æ¨¡æ¿ï¼Œå¯ä»¥æœ‰æ•ˆé¿å… Python çš„é”™è¯¯æç¤ºï¼Œæœç»æ½œåœ¨é—®é¢˜ã€‚

---

### é¢å¤–æç¤º

- **ç³»ç»Ÿç‰ˆæœ¬è¦æ±‚**ï¼šæ™ºè°±æ¸…è¨€éœ€è¦ Home Assistant è‡³å°‘ 8.0 ç‰ˆæœ¬æ”¯æŒã€‚  
- **å»ºè®®**ï¼šå¦‚æœé‡åˆ°å…¼å®¹æ€§é—®é¢˜ï¼Œå»ºè®®é‡å¯æˆ–æ›´æ–°ç³»ç»Ÿã€‚é€šå¸¸è¿™èƒ½è§£å†³å¤§å¤šæ•°é—®é¢˜ã€‚
- **ç›¸å…³é¡¹ç›®**  å¦‚æœéœ€è¦è¯­éŸ³è½¬æ–‡å­—å¯ä»¥ä½¿ç”¨å…è´¹åœ¨çº¿AIæ¨¡å‹é›†æˆï¼Œä¸ªäººäºŒæ¬¡æ·±åº¦ä¿®æ”¹ ````https://github.com/knoop7/groqcloud_whisper````


---

### ğŸ“Š å®æ—¶çŠ¶æ€

#### å½“å‰æ—¶é—´ï¼š16:09:23ï¼Œä»Šæ—¥æ—¥æœŸï¼š2024-10-12ã€‚

#### æ²¹ä»·ä¿¡æ¯ â›½
- 92å·æ±½æ²¹ï¼š7å…ƒ/å‡  
- 95å·æ±½æ²¹ï¼š7å…ƒ/å‡  
- 98å·æ±½æ²¹ï¼š8å…ƒ/å‡  
é¢„è®¡ä¸‹æ¬¡æ²¹ä»·è°ƒæ•´æ—¶é—´ä¸º10æœˆ23æ—¥24æ—¶ï¼Œæ²¹ä»·å¯èƒ½ç»§ç»­ä¸Šæ¶¨ã€‚

#### ç”µè´¹ä½™é¢ âš¡  
- å½“å‰ä½™é¢ï¼š27.5å…ƒ

#### ä»Šæ—¥èƒ½æºæ¶ˆè€— ğŸ’¡  
- ä»Šæ—¥æ¶ˆè€—ï¼š4033.0 Wh  
- æ˜¨æ—¥æ¶ˆè€—ï¼š7.558 kWh

#### ä»Šæ—¥æ–°é—»æ‘˜è¦ ğŸ“°  
1. æ°‘æ”¿éƒ¨å‘å¸ƒå…¨å›½è€å¹´äººå£æ•°æ®ã€‚
